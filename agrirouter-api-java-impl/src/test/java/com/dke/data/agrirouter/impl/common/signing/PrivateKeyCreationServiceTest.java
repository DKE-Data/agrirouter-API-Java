package com.dke.data.agrirouter.impl.common.signing;

import com.dke.data.agrirouter.api.exception.CouldNotCreatePrivateKeyException;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

class PrivateKeyCreationServiceTest {

  @Test
  void givenValidPrivateKey_CreatePrivateKey_ShouldReturnValidResults() {
    // Private key for RQ31.
    String privateKey =
        "-----BEGIN PRIVATE KEY-----MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDYngadA9rWUDCoNQ/orXTId1W3QRrQ7ufLB8CDDY3g7w5hzBDhgPpavZlNrLaGqCzjDzYmSq5Km2KjAvAoGUwYeIhv7E1mK5LUL96PWujMag/FwHhUC3yXfjcyNLrM/zUPPL8dzITyRbdA7zANU2jYOrY13vlEpkP/AImoKDz9iRB6lJhT/JvdUo8TMH7JHNDW6LE4kuWV5VrUzu3fbpg20FjxK23fvA6lA0P+h+7xhL29/D54PfSnlK7jSu7c55L2EwxmtqMLn+ZEuV2bGsO5t7wmo3A9kB40atZJj/3+gFO2kuu/gXEgMQV2tRLU5pu0VhWz9HaJCGd23aGcZeYNAgMBAAECggEALLf24oxMraixWtBVf/HrJYVpRyMkH5TqekIX7pYqP5DqdasUoxEm3fu9PclVhxgJ6DgYNDB/qbxJUSDGpmiOipC7jeuJEPoW3kIhnpOkcqrEpcz1qlgSuQ2f5Hf5Rl+7OvGN/N9fZMqaqceXMnEROG5qdlWZPSBb8jVQtcvUx3wWaFsOOkHqZ4py0bTRLsZiUA3fmbdmNs2dE5CRutCkhZtnHRPZMvb2bxdxQlPm+NlpndCT63mThnry4ohC2bWNOqaaOkeQTwKYTzvu+rej5cGMni/6z/WxnhjID8eisB5ucPwKvWc2IOXBTjlKYB95jQkkQTeCmT/jLn4ZpmP3kQKBgQD6HD/cWB9Fl9ULbvtTBTtJxbFHZNO/j32Qlhw4fPd2b2eEleqMTb22xAeF20vq4xgVcsAr4tvG+boVAy+uZNs5mRVztEtP9WCdOryF/gEVfCG9J77RrkFXSA+puB40nY0IKfQ0ey4g9pY2ZMko9vNTsxKU/J9UONJjromemcETeQKBgQDdt95oCqiZcapjtVHZSLp2V3p1jozic7zfk16bGGFT73fNQt+oGXNH4SzH6j1Oad2GhiJMAnd5hnzsNpNSN80/JL1l0ac/ZcbOKk+Gkc1F4V9X52P7FAOs+epXbKg5iCKA3ztpN110W4WraaGAnf0WvggS74PpaT6bQwUiYe5ONQKBgQCKTbTCk7g3M46LlANGFU6DrN4rLIYrF53HpjpUwkXVKCWGG6BnlVWjCyNd0bZZXNqkgZ/ipMADd3R+yhRDy2GuqAhEwx4iSP3z89bsAVl4F/xQLPpH2KQpL5/5qeaKEdU6/ngbzUHk2HaX/YN/M4+6aPuNh2RTnlg45vsSyNMLgQKBgQDOgSK05LiDskpw88B4EDUbY/663zp48DNKSYgkDGEaPD/o/hAyEQI+QIvk51aSYifh06y9/s4ocgqIN4yfVznjReThoJOViMXR37aSL9pw66hRx0Jn6AxEX8DUDG/ipdj9Du3W4ao5ZcTqEkhJ8tx3Aiei+1JxY4TcN1/g1jWOwQKBgQCSqsUdmttSgb+9Jvp2ciyi+HwPEmuHGRyNSWHXZ6G4zwPDlDJ3s6Tbed5ChqBdFuB+jL9tezfxtJzvfaPmsouZi0h3epXWlG0FxB0D9CLQNO5IAvmJTZft4tF7AD1fXNIvPACqrV23rISFpIhmlQFBB/hpvp02eUuDwkdQcGSKag==-----END PRIVATE KEY-----";
    SecurityKeyCreationService privateKeyCreationService = new SecurityKeyCreationService();
    Assertions.assertNotNull(privateKeyCreationService.createPrivateKey(privateKey));
  }

  @Test
  void givenInvalidPrivateKey_CreatePrivateKey_ShouldThrowException() {
    String invalidPrivateKey =
        "-----BEGIN PRIVATE KEY-----MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXxxxxxxxxoD54PfSnlK7jSu7c55L2EwxmtqMLn+ZEuV2bGsO5t7wmo3A9kB40atZJj/3+gFO2kuu/gXEgMQV2tRLU5pu0VhWz9HaJCGd23aGcZeYNAgMBAAECggEALLf24oxMraixWtBVf/HrJYVpRyMkH5TqekIX7pYqP5DqdasUoxEm3fu9PclVhxgJ6DgYNDB/qbxJUSDGpmiOipC7jeuJEPoW3kIhnpOkcqrEpcz1qlgSuQ2f5Hf5Rl+7OvGN/N9fZMqaqceXMnEROG5qdlWZPSBb8jVQtcvUx3wWaFsOOkHqZ4py0bTRLsZiUA3fmbdmNs2dE5CRutCkhZtnHRPZMvb2bxdxQlPm+NlpndCT63mThnry4ohC2bWNOqaaOkeQTwKYTzvu+rej5cGMni/6z/WxnhjID8eisB5ucPwKvWc2IOXBTjlKYB95jQkkQTeCmT/jLn4ZpmP3kQKBgQD6HD/cWB9Fl9ULbvtTBTtJxbFHZNO/j32Qlhw4fPd2b2eEleqMTb22xAeF20vq4xgVcsAr4tvG+boVAy+uZNs5mRVztEtP9WCdOryF/gEVfCG9J77RrkFXSA+puB40nY0IKfQ0ey4g9pY2ZMko9vNTsxKU/J9UONJjromemcETeQKBgQDdt95oCqiZcapjtVHZSLp2V3p1jozic7zfk16bGGFT73fNQt+oGXNH4SzH6j1Oad2GhiJMAnd5hnzsNpNSN80/JL1l0ac/ZcbOKk+Gkc1F4V9X52P7FAOs+epXbKg5iCKA3ztpN110W4WraaGAnf0WvggS74PpaT6bQwUiYe5ONQKBgQCKTbTCk7g3M46LlANGFU6DrN4rLIYrF53HpjpUwkXVKCWGG6BnlVWjCyNd0bZZXNqkgZ/ipMADd3R+yhRDy2GuqAhEwx4iSP3z89bsAVl4F/xQLPpH2KQpL5/5qeaKEdU6/ngbzUHk2HaX/YN/M4+6aPuNh2RTnlg45vsSyNMLgQKBgQDOgSK05LiDskpw88B4EDUbY/663zp48DNKSYgkDGEaPD/o/hAyEQI+QIvk51aSYifh06y9/s4ocgqIN4yfVznjReThoJOViMXR37aSL9pw66hRx0Jn6AxEX8DUDG/ipdj9Du3W4ao5ZcTqEkhJ8tx3Aiei+1JxY4TcN1/g1jWOwQKBgQCSqsUdmttSgb+9Jvp2ciyi+HwPEmuHGRyNSWHXZ6G4zwPDlDJ3s6Tbed5ChqBdFuB+jL9tezfxtJzvfaPmsouZi0h3epXWlG0FxB0D9CLQNO5IAvmJTZft4tF7AD1fXNIvPACqrV23rISFpIhmlQFBB/hpvp02eUuDwkdQcGSKag==-----END PRIVATE KEY-----";
    SecurityKeyCreationService privateKeyCreationService = new SecurityKeyCreationService();
    Assertions.assertThrows(
        CouldNotCreatePrivateKeyException.class,
        () -> privateKeyCreationService.createPrivateKey(invalidPrivateKey));
  }
}
